<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°„é¾é–€ç¥ç®—åŠ©æ‰‹ - å°ˆæ¥­ç‰ˆ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¯</text></svg>">
    <style>
        :root { --primary: #1a73e8; --danger: #d93025; --warning: #f9ab00; --success: #1e8e3e; }
        body { font-family: sans-serif; background: #f8f9fa; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .container { max-width: 500px; width: 100%; }
        .section { background: white; border-radius: 12px; padding: 15px; margin-bottom: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        h3 { margin: 0 0 10px 0; font-size: 14px; color: #5f6368; display: flex; justify-content: space-between; align-items: center; }
        
        /* è¨­å®šå€ */
        .config-group { display: flex; gap: 8px; align-items: center; margin-bottom: 5px; }
        .num-input { width: 50px; padding: 5px; border-radius: 4px; border: 1px solid #ddd; text-align: center; }
        .apply-btn { background: var(--primary); color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 13px; }

        /* ç®—ç‰Œå€ */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 6px; }
        .card-btn {
            background: white; border: 1px solid #dadce0; border-radius: 8px; padding: 8px 0;
            cursor: pointer; position: relative; transition: 0.1s;
        }
        .card-btn:active { background: #e8f0fe; }
        .card-btn.empty { opacity: 0.3; background: #f1f3f4; }
        .card-btn .val { font-size: 18px; font-weight: bold; display: block; }
        .card-btn .count { font-size: 12px; color: var(--primary); font-weight: bold; }

        /* è©¦ç®—å€ */
        .calc-area { display: flex; flex-direction: column; gap: 10px; }
        .gate-input-group { display: flex; justify-content: space-between; align-items: center; gap: 10px; }
        .gate-select { flex: 1; padding: 10px; font-size: 16px; border-radius: 8px; border: 2px solid #ddd; background: white; }
        
        /* çµæœé¢æ¿ */
        .result-panel { background: #202124; color: white; border-radius: 8px; padding: 15px; text-align: center; margin-top: 5px; }
        .res-row { display: flex; justify-content: space-around; align-items: center; }
        .res-item { display: flex; flex-direction: column; }
        .res-label { font-size: 12px; color: #9aa0a6; }
        .res-num { font-size: 26px; font-weight: bold; }
        .win { color: #81c995; }
        .lose { color: #f28b82; }

        .footer-btns { display: flex; gap: 8px; margin-top: 10px; }
        button.action-btn { flex: 1; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; font-size: 14px; }
        .undo { background: #e8f0fe; color: var(--primary); border: 1px solid #c2e0ff; }
        .reset { background: #fce8e6; color: var(--danger); border: 1px solid #f1c4c4; }
    </style>
</head>
<body>

<div class="container">
    <div class="section">
        <h3>ç‰Œæ•¸è¨­å®š</h3>
        <div class="config-group">
            <span>æ¯ç¨®é»æ•¸å¹¾å¼µï¼š</span>
            <input type="number" id="baseCount" class="num-input" value="4" min="1">
            <button class="apply-btn" onclick="confirmInit()">å¥—ç”¨ä¸¦é‡æ–°é–‹å§‹</button>
        </div>
        <p style="font-size: 11px; color: #999; margin: 5px 0 0 0;">(ä¸€å‰¯ç‰Œé¸ 4ï¼Œå…©å‰¯ç‰Œé¸ 8)</p>
    </div>

    <div class="section">
        <h3>
            <span>1. å‰©é¤˜ç‰Œæ•¸ (é»æ“Šæ‰£é™¤)</span>
            <span id="totalRemain" style="color:var(--primary)">å‰©é¤˜ -- å¼µ</span>
        </h3>
        <div class="grid" id="cardGrid"></div>
        <div class="footer-btns">
            <button class="action-btn undo" onclick="undo()">â†© å›å¾©ä¸€æ­¥</button>
            <button class="action-btn reset" onclick="confirmReset()">â™»ï¸ æ•´å±€æ¸…ç©º</button>
        </div>
    </div>

    <div class="section">
        <h3>2. å°„é¾é–€è©¦ç®—å€</h3>
        <div class="calc-area">
            <div class="gate-input-group">
                <select id="g1" class="gate-select" onchange="calculate()"></select>
                <span style="font-weight:bold">VS</span>
                <select id="g2" class="gate-select" onchange="calculate()"></select>
            </div>
            
            <div id="resultPanel" class="result-panel">
                <div class="res-row">
                    <div class="res-item">
                        <span class="res-label">å°„ä¸­å‹ç‡</span>
                        <span id="winProb" class="res-num win">--%</span>
                    </div>
                    <div class="res-item">
                        <span class="res-label">æ’æŸ±é¢¨éšª</span>
                        <span id="hitProb" class="res-num lose">--%</span>
                    </div>
                </div>
                <div id="advice" style="margin-top: 10px; font-size: 13px; color: #9aa0a6;">è«‹é¸æ“‡å…©å¼µé–€æŸ±</div>
            </div>
        </div>
    </div>
</div>

<script>
    const vals = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
    const map = {'A':1,'2':2,'3':3,'4':4,'5':5,'6':6,'7':7,'8':8,'9':9,'10':10,'J':11,'Q':12,'K':13};
    let counts = {};
    let history = [];

    function init() {
        const startNum = parseInt(document.getElementById('baseCount').value) || 4;
        const grid = document.getElementById('cardGrid');
        const g1 = document.getElementById('g1');
        const g2 = document.getElementById('g2');
        
        grid.innerHTML = '';
        const prevG1 = g1.value;
        const prevG2 = g2.value;
        g1.innerHTML = '<option value="">é–€æŸ±1</option>';
        g2.innerHTML = '<option value="">é–€æŸ±2</option>';

        vals.forEach(v => {
            counts[v] = startNum;
            let btn = document.createElement('button');
            btn.className = 'card-btn';
            btn.id = `btn-${v}`;
            btn.onclick = () => { history.push(v); counts[v]--; update(); };
            btn.innerHTML = `<span class="val">${v}</span><span class="count" id="c-${v}">${startNum}</span>`;
            grid.appendChild(btn);
            
            g1.add(new Option(v, v));
            g2.add(new Option(v, v));
        });
        
        g1.value = prevG1;
        g2.value = prevG2;
        update();
    }

    function update() {
        let total = 0;
        vals.forEach(v => {
            total += counts[v];
            document.getElementById(`c-${v}`).innerText = counts[v];
            document.getElementById(`btn-${v}`).classList.toggle('empty', counts[v] <= 0);
        });
        document.getElementById('totalRemain').innerText = `å‰©é¤˜ ${total} å¼µ`;
        calculate();
    }

    function undo() {
        if(history.length > 0) {
            let last = history.pop();
            counts[last]++;
            update();
        }
    }

    function calculate() {
        const v1 = document.getElementById('g1').value;
        const v2 = document.getElementById('g2').value;
        if(!v1 || !v2) return;

        const n1 = map[v1], n2 = map[v2];
        const min = Math.min(n1, n2), max = Math.max(n1, n2);
        
        let total = 0, winCount = 0, hitCount = 0;
        vals.forEach(v => {
            let w = map[v], c = counts[v];
            total += c;
            if(w > min && w < max) winCount += c;
            if(w === min || w === max) hitCount += c;
        });

        if (total === 0) {
            document.getElementById('winProb').innerText = '0%';
            document.getElementById('hitProb').innerText = '0%';
            return;
        }

        const winP = ((winCount/total)*100).toFixed(1);
        const hitP = ((hitCount/total)*100).toFixed(1);
        
        document.getElementById('winProb').innerText = winP + '%';
        document.getElementById('hitProb').innerText = hitP + '%';
        
        let advice = "";
        if (n1 === n2) advice = "âš ï¸ é–€æŸ±ç›¸åŒï¼šæ’æŸ±è³ é›™å€ï¼Œå°„é€²ç®—è¼¸ï¼";
        else if (winP > 60 && hitP < 10) advice = "ğŸŸ¢ æ©Ÿç‡æ¥µé«˜ï¼šå¤§è†½é€²æ”»ï¼";
        else if (hitP > 15) advice = "ğŸ”´ æ’æŸ±é¢¨éšªå¤§ï¼šå°å¿ƒé›™å€è³ ä»˜";
        else advice = "ğŸŸ¡ å°‹å¸¸æ©Ÿç‡ï¼šå»ºè­°å°æ³¨è©¦æ°´æº«";
        document.getElementById('advice').innerText = advice;
    }

    function confirmInit() {
        if (history.length === 0 || confirm("é€™æœƒé‡æ–°è¨­å®šæ‰€æœ‰ç‰Œæ•¸ï¼Œç¢ºå®šå—ï¼Ÿ")) {
            history = [];
            init();
        }
    }

    function confirmReset() {
        if (confirm("ç¢ºå®šé‡ç½®æœ¬å±€ï¼Ÿ")) {
            history = [];
            init();
        }
    }

    init();
</script>
</body>
</html>
